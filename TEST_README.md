# テストディレクトリ構成

このディレクトリには、Voicepeak APIのテストファイルが整理されています。

## 📁 現在のテストファイル

### メインテストスイート
- **`test_security_suite.py`** - 統合セキュリティテストスイート（**推奨**）

### アーカイブ
- **`archive/old_tests/`** - 統合前の個別テストファイル（参考用）

## 🚀 使用方法

### 基本的なセキュリティテスト
```bash
# ポート3000（コンテナ内部）のテスト
python3 test_security_suite.py --port 3000

# ポート25251（ホスト外部）のテスト  
python3 test_security_suite.py --port 25251 --no-docker
```

### 包括的テスト
```bash
# 全ポートの包括的セキュリティテスト
python3 test_security_suite.py --comprehensive
```

### ヘルプ
```bash
python3 test_security_suite.py --help
```

## 📊 テスト項目

### 1. 🔧 基本機能テスト
- ナレーター一覧取得
- 感情一覧取得

### 2. 🛡️ セキュリティテスト
- **コマンドインジェクション攻撃防御**
  - `;`, `&`, `|`, ``` ` ```, `$()` などの特殊文字
  - パストラバーサル (`../`)
  - 連結攻撃 (`&&`)

- **XSS攻撃防御**
  - `<script>` タグ
  - `<img>`, `<svg>` イベントハンドラ
  - `javascript:` プロトコル

- **入力バリデーション**
  - 空文字チェック
  - 無効な値の検証
  - 長すぎる入力の処理

- **数値パラメータセキュリティ**
  - SQLインジェクション試行
  - 整数オーバーフロー
  - 不正な数値形式

### 3. ⏱️ レート制限テスト
- 連続リクエストによる制限確認
- IP単位での制限機能

## 📈 セキュリティスコア

テスト実行後、以下の形式で結果が表示されます：

```
🛡️ 総合セキュリティスコア: XX.X%
🥇 セキュリティレベル: 最優秀 (本番環境推奨)
```

### スコア基準
- **95%以上**: 🥇 最優秀（本番環境推奨）
- **85%以上**: 🥈 優秀
- **70%以上**: 🥉 良好  
- **70%未満**: ⚠️ 要改善

## 🎯 実装済みセキュリティ機能

- ✅ **コマンドインジェクション防止**: `spawn()`による安全なコマンド実行
- ✅ **入力値検証**: ホワイトリスト方式による厳格な検証
- ✅ **XSS攻撃防止**: HTMLタグフィルタリング
- ✅ **レート制限**: IP単位での制限機能
- ✅ **数値パラメータ検証**: 範囲チェックと型検証
- ✅ **エラーハンドリング**: 情報漏洩防止